{"version":3,"file":"number-range.vue2.js","sources":["../../../../../../packages/components/number-range/src/number-range.vue"],"sourcesContent":["<template>\r\n  <div class=\"liv-number-range\">\r\n    <div v-if=\"$slots.prepend\" class=\"liv-number-range__prepend\">\r\n      <slot name=\"prepend\"></slot>\r\n    </div>\r\n    <div\r\n      class=\"liv-number-range__input\"\r\n      :class=\"{\r\n        'is-disabled': disabled,\r\n        'is-focus': isFocus,\r\n        'has-prepend': $slots.prepend,\r\n        'has-append': $slots.append,\r\n      }\">\r\n      <el-input-number\r\n        class=\"liv-number-range__input--min\"\r\n        :modelValue=\"minModel\"\r\n        :placeholder=\"propsProxy.minPlaceholder\"\r\n        :controls=\"false\"\r\n        :disabled=\"disabled\"\r\n        :min=\"min\"\r\n        :max=\"maxModel ?? max\"\r\n        @update:modelValue=\"handleUpdateMinValue\"\r\n        @blur=\"isFocus = false\"\r\n        @focus=\"!disabled && (isFocus = true)\">\r\n      </el-input-number>\r\n      <div class=\"liv-number-range__input--separator\" :disabled=\"disabled\">\r\n        {{ propsProxy.rangeSeparator }}\r\n      </div>\r\n      <el-input-number\r\n        class=\"liv-number-range__input--min\"\r\n        :modelValue=\"maxModel\"\r\n        :placeholder=\"propsProxy.maxPlaceholder\"\r\n        :controls=\"false\"\r\n        :disabled=\"disabled\"\r\n        :min=\"minModel ?? min\"\r\n        :max=\"max\"\r\n        @update:modelValue=\"handleUpdateMaxValue\"\r\n        @blur=\"isFocus = false\"\r\n        @focus=\"!disabled && (isFocus = true)\">\r\n      </el-input-number>\r\n    </div>\r\n    <div v-if=\"$slots.append\" class=\"liv-number-range__append\">\r\n      <slot name=\"append\"></slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { inject, nextTick, onMounted, ref, watch } from 'vue';\r\nimport { MakeRequired, getPropsPoxy } from '@liv-web/utils';\r\nimport { ElInputNumber } from 'element-plus';\r\nimport type { NumberRangeProps } from './number-range';\r\nimport { NUMBER_RANGE_KEY } from '@liv-web/constants';\r\n\r\n/**\r\n * 组件配置项\r\n */\r\ndefineOptions({\r\n  name: 'LivNumberRange',\r\n});\r\n\r\n/**\r\n * 注入全局属性\r\n */\r\nconst globalProps = inject(NUMBER_RANGE_KEY, {});\r\n\r\n/**\r\n * 组件属性\r\n */\r\nconst props = withDefaults(defineProps<NumberRangeProps>(), {\r\n  min: () => -Infinity,\r\n  max: () => Infinity,\r\n  minPlaceholder: () => '最小值',\r\n  maxPlaceholder: () => '最大值',\r\n  rangeSeparator: () => '至',\r\n  disabled: () => false,\r\n});\r\n\r\n/**\r\n * 属性代理\r\n */\r\nconst propsProxy = getPropsPoxy<\r\n  MakeRequired<\r\n    NumberRangeProps,\r\n    'min' | 'max' | 'minPlaceholder' | 'maxPlaceholder' | 'rangeSeparator' | 'disabled'\r\n  >\r\n>(props, globalProps);\r\n\r\n/**\r\n * 最小值双向绑定\r\n */\r\nconst minModel = defineModel<number | undefined>('minValue', {\r\n  default: undefined,\r\n});\r\n\r\n/**\r\n * 最大值双向绑定\r\n */\r\nconst maxModel = defineModel<number | undefined>('maxValue', {\r\n  default: undefined,\r\n});\r\n\r\n/**\r\n * 是否获得焦点\r\n */\r\nconst isFocus = ref(false);\r\n\r\nconst noEffect = ref(false);\r\n\r\n/**\r\n * 事件\r\n */\r\nconst emit = defineEmits<{\r\n  'update:modelValue': [value: [number | undefined, number | undefined]];\r\n}>();\r\n\r\nonMounted(() => {\r\n  watch(\r\n    () => props.modelValue,\r\n    (newVal, oldVal) => {\r\n      if (noEffect.value) {\r\n        noEffect.value = false;\r\n        return;\r\n      }\r\n      if (!newVal) {\r\n        minModel.value = undefined;\r\n        maxModel.value = undefined;\r\n      } else {\r\n        if (newVal !== oldVal && newVal[0] !== oldVal?.[0] && newVal[1] !== oldVal?.[1]) {\r\n          nextTick(() => {\r\n            minModel.value = newVal[0];\r\n            maxModel.value = newVal[1];\r\n          });\r\n        }\r\n      }\r\n    },\r\n    {\r\n      immediate: true,\r\n      deep: true,\r\n    },\r\n  );\r\n});\r\n\r\nfunction handleUpdateMinValue(e: number | undefined) {\r\n  noEffect.value = true;\r\n  minModel.value = e;\r\n  emit('update:modelValue', [e, maxModel.value]);\r\n}\r\n\r\nfunction handleUpdateMaxValue(e: number | undefined) {\r\n  noEffect.value = true;\r\n  maxModel.value = e;\r\n  emit('update:modelValue', [minModel.value, e]);\r\n}\r\n</script>\r\n"],"names":["inject","NUMBER_RANGE_KEY","getPropsPoxy","_useModel","ref","onMounted","watch","nextTick"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA,IAAA,MAAM,WAAc,GAAAA,UAAA,CAAOC,0BAAkB,EAAA,EAAE,CAAA,CAAA;AAK/C,IAAA,MAAM,KAAQ,GAAA,OAAA,CAAA;AAYd,IAAM,MAAA,UAAA,GAAaC,kBAKjB,CAAA,KAAA,EAAO,WAAW,CAAA,CAAA;AAKpB,IAAM,MAAA,QAAA,GAAWC,YAA+B,CAAA,OAAA,EAAC,UAEhD,CAAA,CAAA;AAKD,IAAM,MAAA,QAAA,GAAWA,YAA+B,CAAA,OAAA,EAAC,UAEhD,CAAA,CAAA;AAKD,IAAM,MAAA,OAAA,GAAUC,QAAI,KAAK,CAAA,CAAA;AAEzB,IAAM,MAAA,QAAA,GAAWA,QAAI,KAAK,CAAA,CAAA;AAK1B,IAAA,MAAM,IAAO,GAAA,MAAA,CAAA;AAIb,IAAAC,aAAA,CAAU,MAAM;AACd,MAAAC,SAAA;AAAA,QACE,MAAM,KAAM,CAAA,UAAA;AAAA,QACZ,CAAC,QAAQ,MAAW,KAAA;AAClB,UAAA,IAAI,SAAS,KAAO,EAAA;AAClB,YAAA,QAAA,CAAS,KAAQ,GAAA,KAAA,CAAA;AACjB,YAAA,OAAA;AAAA,WACF;AACA,UAAA,IAAI,CAAC,MAAQ,EAAA;AACX,YAAA,QAAA,CAAS,KAAQ,GAAA,KAAA,CAAA,CAAA;AACjB,YAAA,QAAA,CAAS,KAAQ,GAAA,KAAA,CAAA,CAAA;AAAA,WACZ,MAAA;AACL,YAAI,IAAA,MAAA,KAAW,MAAU,IAAA,MAAA,CAAO,CAAC,CAAA,MAAM,MAAS,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,MAAA,CAAA,CAAA,CAAA,CAAA,IAAM,MAAO,CAAA,CAAC,CAAM,MAAA,MAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,MAAA,CAAS,CAAI,CAAA,CAAA,EAAA;AAC/E,cAAAC,YAAA,CAAS,MAAM;AACb,gBAAS,QAAA,CAAA,KAAA,GAAQ,OAAO,CAAC,CAAA,CAAA;AACzB,gBAAS,QAAA,CAAA,KAAA,GAAQ,OAAO,CAAC,CAAA,CAAA;AAAA,eAC1B,CAAA,CAAA;AAAA,aACH;AAAA,WACF;AAAA,SACF;AAAA,QACA;AAAA,UACE,SAAW,EAAA,IAAA;AAAA,UACX,IAAM,EAAA,IAAA;AAAA,SACR;AAAA,OACF,CAAA;AAAA,KACD,CAAA,CAAA;AAED,IAAA,SAAS,qBAAqB,CAAuB,EAAA;AACnD,MAAA,QAAA,CAAS,KAAQ,GAAA,IAAA,CAAA;AACjB,MAAA,QAAA,CAAS,KAAQ,GAAA,CAAA,CAAA;AACjB,MAAA,IAAA,CAAK,mBAAqB,EAAA,CAAC,CAAG,EAAA,QAAA,CAAS,KAAK,CAAC,CAAA,CAAA;AAAA,KAC/C;AAEA,IAAA,SAAS,qBAAqB,CAAuB,EAAA;AACnD,MAAA,QAAA,CAAS,KAAQ,GAAA,IAAA,CAAA;AACjB,MAAA,QAAA,CAAS,KAAQ,GAAA,CAAA,CAAA;AACjB,MAAA,IAAA,CAAK,mBAAqB,EAAA,CAAC,QAAS,CAAA,KAAA,EAAO,CAAC,CAAC,CAAA,CAAA;AAAA,KAC/C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}